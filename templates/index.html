<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Extractor de C√≥digo y Cantidad - PDF</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <div class="container">
    <header>
      <h1>
        <span class="icon">üìë</span>
        Extractor de C√≥digos PDF
      </h1>
      <p class="subtitle">Sube tu PDF y extrae c√≥digos y cantidades autom√°ticamente</p>
    </header>

    {% if error %}
    <div class="message error">
      <span>‚ö†Ô∏è</span>
      <span>{{ error }}</span>
    </div>
    {% endif %}

    <section class="upload-section">
      <form method="post" enctype="multipart/form-data">
        <div class="file-input-wrapper">
          <input type="file" name="pdf" id="pdf-input" accept="application/pdf" required>
          <label for="pdf-input" class="file-input-label">
            <span>üìé</span>
            <span class="file-name"></span>
            <span class="default-text">Arrastra tu PDF aqu√≠ o haz clic para seleccionar</span>
          </label>
        </div>

        <div class="button-group">
          <button type="submit" class="btn-primary">
            <span>üöÄ</span>
            Procesar PDF
          </button>
          {% if encontrados or posibles %}
          <button type="button" class="btn-secondary" onclick="window.location.href='/'">
            <span>üîÑ</span>
            Limpiar
          </button>
          {% endif %}
        </div>
      </form>
    </section>

    {% if encontrados %}
    <section class="results-section">
      <div class="section-header encontrados-header">
        <div class="total-count encontrados-count">
          ‚úÖ C√≥digos Encontrados
          <span class="number">{{ total_encontrados }}</span>
        </div>
        <button type="button" class="copy-btn" onclick="copyAllCodes('encontrados')">
          <span>üìã</span>
          Copiar Todos
        </button>
      </div>

      <h2>
        <span>üìä</span>
        Resultados con Alta Confianza
      </h2>

      <div class="table-wrapper">
        <table id="table-encontrados">
          <thead>
            <tr>
              <th>
                <input type="checkbox" id="select-all-encontrados" onchange="toggleSelectAll('encontrados')">
              </th>
              <th>C√≥digo</th>
              <th class="empty-col"></th>
              <th>Cantidad</th>
            </tr>
          </thead>
          <tbody>
            {% for item in encontrados %}
            <tr>
              <td>
                <input type="checkbox" class="row-checkbox encontrados-checkbox" data-codigo="{{ item.codigo }}"
                  data-cantidad="{{ item.cantidad }}">
              </td>
              <td>{{ item.codigo }}</td>
              <td class="empty-col"></td>
              <td>{{ item.cantidad }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
    {% endif %}

    {% if posibles %}
    <section class="results-section posibles-section">
      <div class="section-header posibles-header">
        <div class="total-count posibles-count">
          ‚ö†Ô∏è C√≥digos Posibles
          <span class="number">{{ total_posibles }}</span>
        </div>
        <button type="button" class="copy-btn copy-btn-warning" onclick="copyAllCodes('posibles')">
          <span>üìã</span>
          Copiar Todos
        </button>
      </div>

      <h2 class="posibles-title">
        <span>üîç</span>
        C√≥digos que Requieren Revisi√≥n
      </h2>
      <p class="warning-text">Estos c√≥digos no cumplen completamente el patr√≥n est√°ndar. Rev√≠salos antes de copiar.</p>

      <div class="table-wrapper">
        <table id="table-posibles">
          <thead>
            <tr>
              <th>
                <input type="checkbox" id="select-all-posibles" onchange="toggleSelectAll('posibles')">
              </th>
              <th>C√≥digo</th>
              <th class="empty-col"></th>
              <th>Cantidad</th>
              <th>Raz√≥n</th>
            </tr>
          </thead>
          <tbody>
            {% for item in posibles %}
            <tr>
              <td>
                <input type="checkbox" class="row-checkbox posibles-checkbox" data-codigo="{{ item.codigo }}"
                  data-cantidad="{{ item.cantidad }}">
              </td>
              <td>{{ item.codigo }}</td>
              <td class="empty-col"></td>
              <td>{{ item.cantidad }}</td>
              <td class="razon-cell">{{ item.razon }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
    {% endif %}

    {% if encontrados or posibles %}
    <section class="copy-actions">
      <button type="button" class="btn-primary btn-large" onclick="copySelectedCodes()">
        <span>‚úÖ</span>
        Copiar Seleccionados
      </button>
    </section>
    {% endif %}

    <!-- Notification Toast -->
    <div id="copy-notification" class="copy-notification">
      <span class="notification-icon">‚úÖ</span>
      <span class="notification-text">C√≥digos copiados al portapapeles!</span>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>